{% comment %}
Standardized Contact Card Template
Used for all types of contacts: patient, legal authenticator, custodian, authors
{% endcomment %}

<div class="contact-card contact-card--{{ card_type }}">
    {% if card_title %}
    <div class="contact-card__header">
        <h4 class="contact-card__title">{{ card_title }}</h4>
    </div>
    {% endif %}

    <div class="contact-card__body">
        {% if has_name %}
        <div class="contact-card__section contact-card__name">
            <div class="contact-card__name-primary">
                {{ contact.full_name|default:"Unknown" }}
            </div>
            {% if contact.role %}
            <div class="contact-card__role">
                {{ contact.role }}
            </div>
            {% endif %}
            {% if contact.signature_code %}
            <div class="contact-card__signature">
                Signature: {{ contact.signature_code }}
            </div>
            {% endif %}
        </div>
        {% endif %}

        {% if has_organization %}
        <div class="contact-card__section contact-card__organization">
            <div class="contact-card__org-name">
                <i class="fas fa-building contact-card__icon"></i>
                {{ contact.organization.name }}
            </div>
            {% if contact.organization.id.display %}
            <div class="contact-card__org-id">
                {{ contact.organization.id.display }}
            </div>
            {% endif %}
        </div>
        {% endif %}

        {% if has_address %}
        <div class="contact-card__section contact-card__address">
            <div class="contact-card__section-header">
                <i class="fas fa-map-marker-alt contact-card__icon"></i>
                <span>Address</span>
            </div>
            <div class="contact-card__address-content">
                {% if contact.address.street_address_line %}
                <div class="contact-card__address-line">
                    {{ contact.address.street_address_line }}
                </div>
                {% endif %}

                <div class="contact-card__address-line">
                    {% if contact.address.city %}{{ contact.address.city }}{% endif %}
                    {% if contact.address.state %}{% if contact.address.city %}, {% endif %}{{ contact.address.state
                    }}{% endif %}
                    {% if contact.address.postal_code %} {{ contact.address.postal_code }}{% endif %}
                </div>

                {% if contact.address.country %}
                <div class="contact-card__address-line">
                    {{ contact.address.country }}
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        {% if has_contact_info %}
        <div class="contact-card__section contact-card__telecoms">
            <div class="contact-card__section-header">
                <i class="fas fa-phone contact-card__icon"></i>
                <span>Contact</span>
            </div>
            <div class="contact-card__telecoms-list">
                {% for telecom in contact.telecoms %}
                {% if telecom.display_value %}
                <div class="contact-card__telecom contact-card__telecom--{{ telecom.type }}">
                    <i class="{{ telecom.icon }} contact-card__telecom-icon"></i>
                    <span class="contact-card__telecom-value">{{ telecom.display_value }}</span>
                    {% if telecom.use and telecom.use != 'unknown' %}
                    <span class="contact-card__telecom-use">({{ telecom.use }})</span>
                    {% endif %}
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
        {% endif %}

        {% if has_id %}
        <div class="contact-card__section contact-card__identifier">
            <div class="contact-card__section-header">
                <i class="fas fa-id-card contact-card__icon"></i>
                <span>Identifier</span>
            </div>
            <div class="contact-card__id-content">
                {{ contact.id.display }}
            </div>
        </div>
        {% endif %}

        {% if has_time %}
        <div class="contact-card__section contact-card__timestamp">
            <div class="contact-card__section-header">
                <i class="fas fa-clock contact-card__icon"></i>
                <span>Timestamp</span>
            </div>
            <div class="contact-card__time-content">
                {{ contact.time }}
            </div>
        </div>
        {% endif %}

        {% if contact.code %}
        <div class="contact-card__section contact-card__code">
            <div class="contact-card__section-header">
                <i class="fas fa-code contact-card__icon"></i>
                <span>Professional Code</span>
            </div>
            <div class="contact-card__code-content">
                {% if contact.code.display_name %}
                <div class="contact-card__code-display">{{ contact.code.display_name }}</div>
                {% endif %}
                {% if contact.code.code %}
                <div class="contact-card__code-value">
                    Code: {{ contact.code.code }}
                    {% if contact.code.code_system %}({{ contact.code.code_system }}){% endif %}
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</div>