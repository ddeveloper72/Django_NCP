{% extends "base.html" %}

{% block title %}PS Display Guidelines Table Test{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-12">
            <h1 class="page-title">PS Display Guidelines Table Rendering Test</h1>
            <p class="text-muted">Testing clinical information rendering in standardized tables</p>
        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h3>Original CDA Sections ({{ source_language|upper }})</h3>
                </div>
                <div class="card-body">
                    {% for section in original_sections %}
                    <div class="section mb-4">
                        <h4>{{ section.title }}</h4>
                        <p><strong>Section Code:</strong> {{ section.section_code or 'Not specified' }}</p>
                        
                        {% if section.tables %}
                            <h5>Original Tables:</h5>
                            {% for table in section.tables %}
                            <table class="table table-striped table-sm">
                                <thead class="table-dark">
                                    <tr>
                                        {% for header in table.headers %}
                                        <th>{{ header }}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for row in table.rows %}
                                    <tr>
                                        {% for cell in row %}
                                        <td>{{ cell }}</td>
                                        {% endfor %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% endfor %}
                        {% endif %}
                        
                        <div class="section-content">
                            <small class="text-muted">{{ section.content[:200] }}...</small>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h3>PS Display Guidelines Tables (EN)</h3>
                </div>
                <div class="card-body">
                    {% for section in translated_sections %}
                    <div class="section mb-4">
                        <h4>{{ section.title_translated }}</h4>
                        <p><strong>Section Code:</strong> {{ section.section_code or 'Not specified' }}</p>
                        
                        {% if section.ps_table_html %}
                            <h5>PS Guidelines Standardized Table:</h5>
                            <div class="ps-table-container">
                                {{ section.ps_table_html|safe }}
                            </div>
                        {% else %}
                            <div class="alert alert-warning">
                                <strong>No PS table rendered.</strong>
                                <br>Section code: {{ section.section_code }}
                                <br>This indicates the clinical information isn't being rendered in tables.
                            </div>
                        {% endif %}
                        
                        {% if section.tables %}
                            <h5>Translated Original Tables:</h5>
                            {% for table in section.tables %}
                            <table class="table table-striped table-sm">
                                <thead class="table-dark">
                                    <tr>
                                        {% for header in table.headers_translated %}
                                        <th>{{ header }}</th>
                                        {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for row in table.rows %}
                                    <tr>
                                        {% for cell in row %}
                                        <td>{{ cell }}</td>
                                        {% endfor %}
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% endfor %}
                        {% endif %}
                        
                        <div class="section-content">
                            <small class="text-muted">{{ section.content_translated[:200] }}...</small>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
/* PS Display Guidelines Table Styles */
.ps-table-container {
    margin: 15px 0;
    border: 1px solid #ddd;
    border-radius: 4px;
    overflow-x: auto;
}

.ps-table {
    width: 100%;
    border-collapse: collapse;
    font-family: Arial, sans-serif;
    font-size: 14px;
    background: white;
}

.ps-thead {
    background: #f8f9fa;
    border-bottom: 2px solid #dee2e6;
}

.ps-th {
    padding: 12px 8px;
    text-align: left;
    font-weight: 600;
    color: #495057;
    border: 1px solid #dee2e6;
}

.ps-tbody .ps-tr {
    border-bottom: 1px solid #dee2e6;
}

.ps-td {
    padding: 10px 8px;
    border: 1px solid #dee2e6;
    vertical-align: top;
}

.ps-row-even {
    background: #ffffff;
}

.ps-row-odd {
    background: #f8f9fa;
}

.ps-tr:hover {
    background: #e3f2fd !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .ps-table {
        font-size: 12px;
    }
    
    .ps-th,
    .ps-td {
        padding: 6px 4px;
    }
}
</style>
{% endblock %}
