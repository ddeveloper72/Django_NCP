{% extends "base.html" %}
{% load static %}

{% block title %}EU eHealth NCP Portal - Irish Healthcare Cross-Border Services{% endblock %}

{% block content %}
<!-- Mobile-First Healthcare Organisation Themed Home Page -->

<!-- Hero Section with Enhanced Visual Appeal -->
<section class="hero-section">
    <div class="hero-background"></div>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10 col-xl-8">
                <div class="hero-content text-center">
                    <div class="hero-badge mb-3">
                        <span class="badge bg-light text-dark">
                            <i class="fa fa-shield" aria-hidden="true"></i>
                            GDPR Compliant Healthcare Platform
                        </span>
                    </div>
                    <h1 class="hero-title mb-4">
                        EU eHealth <span class="text-hco-teal">NCP Portal</span>
                    </h1>
                    <p class="hero-subtitle mb-5">
                        Cross-border healthcare document exchange platform connecting Irish healthcare services with European member states through secure, standardized protocols.
                    </p>
                    <div class="hero-stats row g-3 justify-content-center">
                        <div class="col-6 col-md-3">
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fa fa-globe" aria-hidden="true"></i>
                                </div>
                                <div class="stat-number">27</div>
                                <div class="stat-label">EU Countries</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fa fa-shield" aria-hidden="true"></i>
                                </div>
                                <div class="stat-number">100%</div>
                                <div class="stat-label">GDPR Secure</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fa-regular fa-clock" aria-hidden="true"></i>
                                </div>
                                <div class="stat-number">24/7</div>
                                <div class="stat-label">Available</div>
                            </div>
                        </div>
                        <div class="col-6 col-md-3">
                            <div class="stat-item">
                                <div class="stat-icon">
                                    <i class="fa fa-heartbeat" aria-hidden="true"></i>
                                </div>
                                <div class="stat-number"><i class="fa fa-infinity"></i></div>
                                <div class="stat-label">Patient Care</div>
                            </div>
                        </div>
                    </div>
</section>

<!-- Core Services Section -->
<section class="services-section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-header text-center mb-5">
                    <h2 class="section-title">
                        <i class="fa fa-hospital-o me-3" aria-hidden="true"></i>
                        Healthcare Services
                    </h2>
                    <p class="section-subtitle">
                        Professional tools for cross-border healthcare management and patient care coordination
                    </p>
                </div>
            </div>
        </div>

        <div class="row g-4">
            <!-- Patient Search Service -->
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-hco-teal">
                            <i class="fa fa-user-md" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">Patient Search</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">
                            Search for patients across EU member states with break-the-glass emergency access capabilities. GDPR-compliant cross-border patient data retrieval with real-time verification.
                        </p>
                        <ul class="service-features">
                            <li><i class="fa fa-check"></i>EU-wide patient lookup</li>
                            <li><i class="fa fa-check"></i>Emergency access protocols</li>
                            <li><i class="fa fa-check"></i>GDPR compliance</li>
                        </ul>
                    </div>
                    <div class="service-card-footer">
                        <a href="/patients/search/" class="btn btn-hco-teal btn-service">
                            <i class="fa fa-search"></i>
                            Search Patients
                        </a>
                    </div>
                </div>
            </div>

            <!-- Portal Service -->
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-hco-green">
                            <i class="fa fa-globe" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">European Portal</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">
                            Full eHealth portal with European SMP integration, country-specific International Search Masks (ISM), and comprehensive cross-border patient lookup capabilities.
                        </p>
                        <ul class="service-features">
                            <li><i class="fa fa-check"></i>SMP integration</li>
                            <li><i class="fa fa-check"></i>Country-specific ISM</li>
                            <li><i class="fa fa-check"></i>Cross-border lookup</li>
                        </ul>
                    </div>
                    <div class="service-card-footer">
                        <a href="/portal/" class="btn btn-hco-green btn-service">
                            <i class="fa fa-external-link"></i>
                            Launch Portal
                        </a>
                    </div>
                </div>
            </div>

            <!-- SMP Management Service -->
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-primary">
                            <i class="fa fa-sitemap" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">SMP Management</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">
                            Service Metadata Publishing for EU eHealth network. Manage participants, generate signed documents, and synchronize with European SMP servers.
                        </p>
                        <ul class="service-features">
                            <li><i class="fa fa-check"></i>Metadata publishing</li>
                            <li><i class="fa fa-check"></i>Digital signatures</li>
                            <li><i class="fa fa-check"></i>Server synchronization</li>
                        </ul>
                    </div>
                    <div class="service-card-footer">
                        <a href="/smp/" class="btn btn-primary btn-service">
                            <i class="fa fa-cogs"></i>
                            SMP Dashboard
                        </a>
                    </div>
                </div>
            </div>

            <!-- Admin Service (Conditional) -->
            {% if request.user.is_staff %}
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card h-100 admin-card">
                    <div class="service-card-header">
                        <div class="service-icon bg-warning">
                            <i class="fa fa-shield" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">
                            System Administration
                            <span class="badge bg-warning text-dark ms-2">Admin</span>
                        </h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">
                            Administrative interface for managing the eHealth system, user permissions, and system configuration. Full Django admin panel access.
                        </p>
                        <ul class="service-features">
                            <li><i class="fa fa-check"></i>User management</li>
                            <li><i class="fa fa-check"></i>System configuration</li>
                            <li><i class="fa fa-check"></i>Security controls</li>
                        </ul>
                    </div>
                    <div class="service-card-footer">
                        <a href="/admin/" class="btn btn-warning btn-service">
                            <i class="fa fa-wrench"></i>
                            Admin Panel
                        </a>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Translation Service -->
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-info">
                            <i class="fa fa-language" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">CDA Translation</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">
                            Convert between CDA (Clinical Document Architecture) and FHIR formats for interoperability across European healthcare systems.
                        </p>
                        <ul class="service-features">
                            <li><i class="fa fa-check"></i>CDA to FHIR</li>
                            <li><i class="fa fa-check"></i>Format validation</li>
                            <li><i class="fa fa-check"></i>Interoperability</li>
                        </ul>
                    </div>
                    <div class="service-card-footer">
                        <a href="/translation/" class="btn btn-hco-teal btn-service">
                            <i class="fa fa-exchange"></i>
                            Translation Services
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Technical Capabilities Section -->
<section class="capabilities-section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-header text-center mb-5">
                    <h2 class="section-title">
                        <i class="fa fa-cogs me-3" aria-hidden="true"></i>
                        System Capabilities
                    </h2>
                    <p class="section-subtitle">
                        Advanced healthcare technology stack ensuring secure, compliant, and reliable cross-border services
                    </p>
                </div>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-12 col-md-6 col-xl-3">
                <div class="capability-card text-center h-100">
                    <div class="capability-icon">
                        <i class="fa fa-shield" aria-hidden="true"></i>
                    </div>
                    <h4 class="capability-title">GDPR Compliant</h4>
                    <p class="capability-description">
                        Full compliance with European data protection regulations and healthcare privacy standards.
                    </p>
                </div>
            </div>

            <div class="col-12 col-md-6 col-xl-3">
                <div class="capability-card text-center h-100">
                    <div class="capability-icon">
                        <i class="fa fa-globe" aria-hidden="true"></i>
                    </div>
                    <h4 class="capability-title">Cross-Border Integration</h4>
                    <p class="capability-description">
                        Seamless integration with EU member state healthcare systems through standardized protocols.
                    </p>
                </div>
            </div>

            <div class="col-12 col-md-6 col-xl-3">
                <div class="capability-card text-center h-100">
                    <div class="capability-icon">
                        <i class="fa fa-key" aria-hidden="true"></i>
                    </div>
                    <h4 class="capability-title">Emergency Access</h4>
                    <p class="capability-description">
                        Break-the-glass capabilities for emergency patient data access across international borders.
                    </p>
                </div>
            </div>

            <div class="col-12 col-md-6 col-xl-3">
                <div class="capability-card text-center h-100">
                    <div class="capability-icon">
                        <i class="fa-regular fa-clock" aria-hidden="true"></i>
                    </div>
                    <h4 class="capability-title">24/7 Availability</h4>
                    <p class="capability-description">
                        Round-the-clock service availability ensuring healthcare access when patients need it most.
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Configuration & API Section -->
<section class="configuration-section">
    <div class="container">
        <div class="row g-4">
            <!-- SMP Configuration Card -->
            <div class="col-12 col-lg-6">
                <div class="config-card h-100">
                    <div class="config-header">
                        <div class="config-icon">
                            <i class="fa fa-server" aria-hidden="true"></i>
                        </div>
                        <h3 class="config-title">Active SMP Configuration</h3>
                    </div>
                    <div class="config-body">
                        <div class="config-detail">
                            <span class="config-label">Source:</span>
                            <span class="config-value">{{ current_smp_name|default:"Default SMP Server" }}</span>
                        </div>
                        <div class="config-detail">
                            <span class="config-label">Portal URL:</span>
                            <a href="{{ current_smp_ui_url }}" target="_blank" class="config-link" rel="noopener">
                                {{ current_smp_ui_url|default:"Not configured" }}
                                <i class="fa fa-external-link ms-1" aria-hidden="true"></i>
                            </a>
                        </div>
                        <div class="config-note">
                            <i class="fa fa-info-circle" aria-hidden="true"></i>
                            <span>Configuration managed by system administrators</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- API Endpoints Card -->
            <div class="col-12 col-lg-6">
                <div class="config-card h-100">
                    <div class="config-header">
                        <div class="config-icon">
                            <i class="fa fa-code" aria-hidden="true"></i>
                        </div>
                        <h3 class="config-title">API Endpoints</h3>
                    </div>
                    <div class="config-body">
                        <div class="api-endpoint-list">
                            <div class="api-endpoint-item">
                                <div class="api-method get">GET</div>
                                <div class="api-details">
                                    <a href="/api/countries/" class="api-url">/api/countries/</a>
                                    <p class="api-description">Get available EU countries with ISM support</p>
                                </div>
                            </div>

                            <div class="api-endpoint-item">
                                <div class="api-method post">POST</div>
                                <div class="api-details">
                                    <span class="api-url">/api/patient/lookup/</span>
                                    <p class="api-description">Cross-border patient lookup with validation</p>
                                </div>
                            </div>

                            <div class="api-endpoint-item">
                                <div class="api-method get">GET</div>
                                <div class="api-details">
                                    <span class="api-url">/api/patient/{id}/document/{type}/</span>
                                    <p class="api-description">Retrieve patient documents from EU systems</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- External Services Section -->
<section class="external-services-section">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="section-header text-center mb-5">
                    <h2 class="section-title">
                        <i class="fa fa-link" aria-hidden="true"></i>
                        External Service Connections
                    </h2>
                    <p class="section-subtitle">
                        Integration with existing healthcare infrastructure and legacy systems
                    </p>
                </div>
            </div>
        </div>

                <div class="row g-4 justify-content-center">
            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card external-service-card text-center h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-hco-teal">
                            <i class="fa-brands fa-java" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">Java OpenNCP Portal</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">Original Java-based portal integration for legacy system compatibility</p>
                    </div>
                    <div class="service-card-footer">
                        <a href="http://localhost:8093" target="_blank" class="btn btn-outline-primary external-cta-btn" rel="noopener">
                            <i class="fa fa-external-link"></i>
                            localhost:8093
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-6 col-lg-4">
                <div class="service-card external-service-card text-center h-100">
                    <div class="service-card-header">
                        <div class="service-icon bg-hco-teal">
                            <i class="fa fa-database" aria-hidden="true"></i>
                        </div>
                        <h3 class="service-title">DomiSMP Server</h3>
                    </div>
                    <div class="service-card-body">
                        <p class="service-description">Service Metadata Publisher for European health network integration</p>
                    </div>
                    <div class="service-card-footer">
                        <a href="{{ current_smp_ui_url }}" target="_blank" class="btn btn-outline-secondary external-cta-btn" rel="noopener">
                            <i class="fa fa-external-link"></i>
                            SMP Portal
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- System Status Section -->
<section class="system-status-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-12 col-lg-10">
                <div class="system-status-card">
                    <div class="status-header">
                        <div class="status-badge">
                            <i class="fa {% if system_status.overall_status == 'operational' %}fa-check-circle{% elif system_status.overall_status == 'warning' %}fa-exclamation-triangle text-warning{% else %}fa-times-circle text-danger{% endif %}" aria-hidden="true"></i>
                            <span class="status-label">System {% if system_status.overall_status == 'operational' %}Operational{% elif system_status.overall_status == 'warning' %}Warning{% elif system_status.overall_status == 'degraded' %}Degraded{% else %}{{ system_status.overall_status|title }}{% endif %}</span>
                        </div>
                        <div class="last-updated">
                            Last updated: <time>{{ system_status.last_updated|date:"M d, Y H:i" }}</time>
                        </div>
                    </div>
                    <div class="status-details">
                        <div class="status-grid">
                            <div class="status-item">
                                <div class="status-metric">
                                    <i class="fa fa-globe {% if system_status.components.api_gateway.status == 'online' %}text-success{% elif system_status.components.api_gateway.status == 'warning' %}text-warning{% else %}text-danger{% endif %}" aria-hidden="true"></i>
                                    <span class="metric-label">API Gateway</span>
                                    <span class="metric-status {% if system_status.components.api_gateway.status == 'online' %}online{% elif system_status.components.api_gateway.status == 'warning' %}warning{% else %}offline{% endif %}">{{ system_status.components.api_gateway.label }}</span>
                                </div>
                            </div>
                            <div class="status-item">
                                <div class="status-metric">
                                    <i class="fa fa-database {% if system_status.components.smp_services.status == 'online' %}text-success{% elif system_status.components.smp_services.status == 'warning' %}text-warning{% else %}text-danger{% endif %}" aria-hidden="true"></i>
                                    <span class="metric-label">SMP Services</span>
                                    <span class="metric-status {% if system_status.components.smp_services.status == 'online' %}online{% elif system_status.components.smp_services.status == 'warning' %}warning{% else %}offline{% endif %}">{{ system_status.components.smp_services.label }}</span>
                                </div>
                            </div>
                            <div class="status-item">
                                <div class="status-metric">
                                    <i class="fa fa-shield {% if system_status.components.authentication.status == 'online' %}text-success{% elif system_status.components.authentication.status == 'warning' %}text-warning{% else %}text-danger{% endif %}" aria-hidden="true"></i>
                                    <span class="metric-label">Authentication</span>
                                    <span class="metric-status {% if system_status.components.authentication.status == 'online' %}online{% elif system_status.components.authentication.status == 'warning' %}warning{% else %}offline{% endif %}">{{ system_status.components.authentication.label }}</span>
                                </div>
                            </div>
                        </div>
                        <div class="integration-note">
                            <i class="fa fa-info-circle" aria-hidden="true"></i>
                            Authentication-free access available for Java portal integration and external services.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
